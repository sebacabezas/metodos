apply(base_potencia_8,2, mean)
apply(base_potencia_8,2, mean)[1]
base_potencia_8[1,2]
base_potencia_8[1,2]-apply(base_potencia_8,2, mean)[1]
base_potencia_8[2,1]-apply(base_potencia_8,2, mean)[1]
t(apply(base_potencia_8,2, mean))
apply(base_potencia_8,2, mean)
colSums(base_potencia_8)
c1 = colSums(base_potencia_8)
var_por_cols = apply(base_potencia_8,2,var)
var_por_cols
media_por_cols = apply(base_potencia_8,2, mean)
var_por_cols = apply(base_potencia_8,2,var)
base_potencia_8 = scale(base_potencia_8, center = FALSE, scale = c1)
base_potencia_8
colSums(base_potencia_8)
base_potencia_8[1,]
base_potencia_8[,1;3]
base_potencia_8[,1:3]
base_potencia_8[1:3,]
base_potencia_8[1:length(datos$X),]
regresion_4 = lm(datos$ytest ~ base_potencia_8[1:length(datos$X,)])
regresion_4 = lm(datos$ytest ~ base_potencia_8[1:length(datos$X),])
base_potencia_8[1:length(datos$X),]
regresion_4 = lm(datos$y ~ base_potencia_8[1:length(datos$X),])
regresion_4
summary(regresion_4)
plot(datos$y)
grilla = seq(0,14,length=10000)
regresion_4$coefficients[1]
regresion_4$coefficients[[1]]
lines(x, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*x + regresion_4$coefficients[[3]]*x^2 +
regresion_4$coefficients[[4]]*x^3 + regresion_4$coefficients[[5]]*x^4 +
regresion_4$coefficients[[6]]*x^5 + regresion_4$coefficients[[7]]*x^6 +
regresion_4$coefficients[[8]]*x^7 + regresion_4$coefficients[[9]]*x^8)
grilla = seq(0,14,length=10000)
plot(datos$y)
lines(x, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
grilla = 1
regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8
plot(datos$y, datos$X)
abline(regresion1$coefficients[[1]], regresion1$coefficients[[2]])
plot(datos$y, datos$X)
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
regresion_4$coefficients[[5]]
grilla = seq(0,14,length=10000)
plot(datos$y, datos$X)
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
grilla = seq(0,50,length=10000)
plot(datos$y, datos$X)
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
plot(datos$y, datos$X, ylim = c(-60,140))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
grilla = datos$X
plot(datos$y, datos$X, ylim = c(-60,140))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
grilla = seq(0,50,length=10000)
plot(datos$y, datos$X, ylim = c(-60,140))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
plot(datos$y, datos$X, ylim = c(-60,1400))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
regresion_4 = lm(datos$y ~ base_potencia_8[1:length(datos$X),])
regresion_4$coefficients
grilla = seq(0,50,length=10000000)
plot(datos$y, datos$X, ylim = c(-60,1400))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8)
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
base_potencia_8[1:length(datos$X)
)
base_potencia_8[1:length(datos$X),]
regresion_4 = lm(datos$y ~ poly(rbind(datos$X, datos$Xval, datos$Xtest), degree = 8, raw = TRUE, simple = TRUE)[1:length(datos$X),])
grilla = seq(0,50,length=1000000)
plot(datos$y, datos$X, ylim = c(-60,1400))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
regresion_4$coefficients
plot(datos$y, datos$X, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
grilla = seq(0,50,length=100000)
plot(datos$y, datos$X, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
regresion_4 = lm(datos$y ~ poly(rbind(datos$X), degree = 8, raw = TRUE, simple = TRUE)[1:length(datos$X),])
grilla = seq(0,50,length=100000)
plot(datos$y, datos$X, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
regresion_4 = lm(datos$y ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:length(datos$X),])
grilla = seq(0,50,length=100000)
plot(datos$y, datos$X, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
regresion_4 = lm(datos$y ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
grilla = seq(0,50,length=100000)
plot(datos$y, datos$X, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
plot(datos$X, datos$y, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
grilla = seq(-50,50,length=100000)
plot(datos$X, datos$y, ylim = c(-60,60))
lines(grilla, regresion_4$coefficients[[1]] + regresion_4$coefficients[[2]]*grilla + regresion_4$coefficients[[3]]*grilla^2 +
regresion_4$coefficients[[4]]*grilla^3 + regresion_4$coefficients[[5]]*grilla^4 +
regresion_4$coefficients[[6]]*grilla^5 + regresion_4$coefficients[[7]]*grilla^6 +
regresion_4$coefficients[[8]]*grilla^7 + regresion_4$coefficients[[9]]*grilla^8, col = "green")
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[c(1,2),])
datos$y[c(1,2)]
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,1])
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,1])
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,])
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[,1])
poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[,1]
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[,1])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[,c(1,2)])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[c(1,2)])
poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[,c(1,2)]
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,c(1,2)])
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,c(1)])
poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[,c(1)]
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,c(1)])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,c(1,2)])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,c(1,2,3)])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,c(1,2,3,4)])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:3,])
lm(datos$y[c(1,2,3)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:3,])
lm(datos$y[c(1)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1,])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:3,])
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,])
i = 2
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
reg
pred1 = predict(reg, data.frame("x1" = datos$X[1:i]))
as.data.frame(poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
base_poly = as.data.frame(poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
colnames(base_poly) = c("X_1","X_2","X_3","X_4","X_5","X_6","X_7","X_8")
base_poly
x1 =  base_poly[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:2,1])
pred1 = predict(reg, base_poly[1,1:2])
pred1 = predict(reg, base_poly[1:2,1:2])
pred1
i = 3
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:2,1:2])
pred1
reg
pred1
mean((pred1 - datos$y[1:i])^2)
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:3,1:3])
pred1
pred2 = predict(reg, base_poly[,1:3])
pred2
pred2 = predict(reg, base_poly[1:3,])
pred2
reg
i = 4
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:i,1:i])
pred1
pred2
pred2 = predict(reg, base_poly[1:3,])
pred2
base_poly[1:3,]
pred2 = predict(reg, base_poly[,1:i])
pred2
base_poly[,1:i]
base_poly = as.data.frame(poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
colnames(base_poly) = c("x1","x2","x3","x4","x5","x6","x7","x8")
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:i,1:i])
pred1
pred2 = predict(reg, base_poly[,1:i])
pred2
base_poly[,1:i]
poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
reg
base_poly = as.data.frame(poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
colnames(base_poly) = c("x11","x12","x13","x14","x15","x16","x17","x18")
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:i,1:i])
pred1
pred2 = predict(reg, base_poly[,1:i])
pred2
base_poly[,1:i]
reg
pred2 = predict(reg, base_poly[,1:i])
reg
data.frame("x1" = datos$Xval)
reg
pred2 = predict(reg, base_poly[,1:i])
reg
poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,]
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:i,1:i])
pred2 = predict(reg, base_poly[,1:i])
pred2
reg
reg
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i-1]
y1 = datos$y[1:i]
reg = lm(y1~x1)
reg
pred1 = predict(reg, base_poly[1:i,1:i])
pred2 = predict(reg, base_poly[,1:i])
pred2
reg
base_poly[,1:i]
pred2 = predict(reg, base_poly[,1:i-1])
pred2
reg
base_poly[,1:i-1]
pred2 = predict(reg, base_poly[,1:i-1])
reg
base_poly[,1:i-1]
pred1 = predict(reg, base_poly[1:i,1:i])
pred1
reg
base_poly[1:i,1:i]
pred1 = predict(reg, base_poly[1:i-1,1:i-1])
pred1 = predict(reg, base_poly[1:i,1:i-1])
pred1
reg
base_poly[1:i,1:i-1]
pred1 = predict(reg, base_poly[1:i+1,1:i-1])
pred1
reg
base_poly[1:i+1,1:i-1]
pred1 = predict(reg, base_poly[1:5,1:i-1])
pred1 = predict(reg, base_poly[1:4,1:i-1])
pred1 = predict(reg, base_poly[1:4,1:i])
pred1 = predict(reg, base_poly[1:4,1:4])
pred1 = predict(reg, base_poly[1:4,1:6])
base_poly[1:4,1:6]
pred1
pred1 = predict(reg, base_poly[1:4,1:5])
pred1
x1 = datos$X[1:i]
y1 = datos$y[1:i]
reg = lm(y1~x1)
reg
pred1 = predict(reg, data.frame("x1" = datos$X[1:i]))
pred2 = predict(reg, newdata = data.frame("x1" = datos$Xval))
reg
data.frame("x1" = datos$Xval)
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i-1]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, base_poly[1:4,1:5])
pred2 = predict(reg, base_poly[,1:i-1])
pred1 = predict(reg, base_poly[1:i,1:i])
pred1 = predict(reg, base_poly[1:i,1:i])
reg
base_poly[1:i,1:i]
base_poly[,1:i-1]
reg
pred2 = predict(reg, base_poly[,1:i-1])
class(base_poly)
library(mgcv)
pred1 = predict.matrix(reg, base_poly[1:i,1:i-1])
pred1 = Predict.matrix(reg, base_poly[1:i,1:i-1])
pred2 = predict(reg, base_poly[1:10,1:i-1])
pred2 = predict(reg, base_poly[,1:i-1])
reg
base_poly[,1:i-1]
pred2 = predict(reg, base_poly[,1:i-2])
pred2
pred2 = predict(reg, base_poly[,1:i-3])
pred2 = predict(reg, base_poly[,1:i])
pred2 = predict(reg, base_poly[,1:i+1])
pred2 = predict(reg, base_poly[,1:i+2])
pred2 = predict(reg, base_poly)
pred2 = predict(reg, base_poly[1,])
pred2 = predict(reg, base_poly[1:4,])
pred2
pred2 = predict(reg, base_poly[2:5,])
pred2
x1 = poly(rbind(datos$X, datos$Xval), degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i-1]
y1 = rbind(datos$y,datos$yval)[1:i]
reg = lm(y1~x1, subset = c(1,2))
reg
reg = lm(y1~x1, subset = c(1))
reg
reg = lm(y1~x1, subset = c(1:i))
reg
reg$residuals
x1 = poly(rbind(datos$X, datos$Xval), degree = 8, raw = TRUE, simple = TRUE)
y1 = rbind(datos$y,datos$yval)
reg = lm(y1~x1, subset = c(1:i))
reg
reg$residuals
pred2 = predict(reg, base_poly[1,])
pred2
base_poly[1,]
reg
pred2 = predict(reg, base_poly[1,])
pred2
rm(pred2)
pred2 = predict(reg, base_poly[1,])
pred2
pred2 = predict(reg, base_poly[1:2,])
pred2
pred2 = predict(reg, base_poly)
pred2
i = 3
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i-1]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = Predict.matrix(reg, base_poly[1:i,1:i-1])
pred2 = predict(reg, base_poly)
pred2
x1
reg = lm(y1~x1)
reg
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i-1,1:i-1]
y1 = datos$y[1:i]
y1
y1 = datos$y[1:i-1]
reg = lm(y1~x1)
reg
x1
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i]
y1 = datos$y[1:i]
reg = lm(y1~x1)
x1
y1
reg
y1 = datos$y[1:i-1
reg = lm(y1~x1)
pred1 = Predict.matrix(reg, base_poly[1:i,1:i-1])
pred2 = predict(reg, base_poly)
ECM1 = c(ECM1, mean((pred1 - datos$y[1:i])^2))
ECM2 = c(ECM2, mean((pred2 - datos$yval)^2))
}
#Modelo con 9 datos o más
base_poly = as.data.frame(poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
colnames(base_poly) = c("x11","x12","x13","x14","x15","x16","x17","x18")
for (i in 9:length(datos$X)) {
x1 = datos$X[1:i]
y1 = datos$y[1:i]
reg = lm(y1~x1)
pred1 = predict(reg, data.frame("x1" = datos$X[1:i]))
pred2 = predict(reg, newdata = as.data.frame("x1" = datos$Xval))
ECM1 = c(ECM1, mean((pred1 - datos$y[1:i])^2))
ECM2 = c(ECM2, mean((pred2 - datos$yval)^2))
}
plot(seq(1,12),  ECM1, xlim = c(-0,16), ylim = c(0,300))
lines(ECM2)
# Podemos ver que convergen al mismo valor
lm(datos$y[c(1,2)] ~ poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:2,])
y1 = datos$y[1:i-1]
reg = lm(y1~x1)
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i]
y1 = datos$y[1:i-1]
reg = lm(y1~x1)
i = 3
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i]
y1 = datos$y[1:i-1]
reg = lm(y1~x1)
y1
x1
y1 = datos$y[1:i]
reg = lm(y1~x1)
reg
pred1 = Predict.matrix(reg, base_poly[1:i,1:i-1])
reg = lm(y1~x1)
pred1 = Predict.matrix(reg, base_poly[1:i,1:i-1])
pred1 = Predict(reg, base_poly[1:i,1:i-1])
pred1 = predict(reg, base_poly[1:i,1:i-1])
pred1
pred2 = predict(reg, base_poly)
pred2
base_poly_2 = as.data.frame(poly(datos$Xval, degree = 8, raw = TRUE, simple = TRUE))
pred2 = predict(reg, base_poly2)
base_poly_2 = as.data.frame(poly(datos$Xval, degree = 8, raw = TRUE, simple = TRUE))
pred2 = predict(reg, base_poly_2)
pred2
pred1 = predict(reg, base_poly[1:i,1:i-1])
pred1
reg
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i-1,1:i]
y1 = datos$y[1:i]
reg = lm(y1~x1)
x1 =  poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)[1:i,1:i-1]
y1 = datos$y[1:i]
reg = lm(y1~x1)
reg
pred1 = predict(reg, base_poly[1:i,1:i-1])
pred2 = predict(reg, base_poly_2)
pred1
reg
base_poly[1:i,1:i-1]
pred1 = predict(reg, base_poly[1:i+1,1:i-1])
pred1
pred1 = predict(reg, base_poly[1:i+1,1:i-1])
base_poly[1:i+1,1:i-1])
base_poly[1:i+1,1:i-1]
pred1 = predict(reg, base_poly[1:i+2,1:i-1])
base_poly[1:i+2,1:i-1]
pred1 = predict(reg, base_poly[1:(i+2),1:i-1])
pred1
pred1 = predict(reg, base_poly[1:(i+2),1:(i-1)])
reg
pred1 = predict(reg, base_poly[1:(i),1:(i-1)])
pred1
colnames(base_poly2) = c("x11","x12","x13","x14","x15","x16","x17","x18")
base_poly_2 = as.data.frame(poly(datos$Xval, degree = 8, raw = TRUE, simple = TRUE))
colnames(base_poly2) = c("x11","x12","x13","x14","x15","x16","x17","x18")
colnames(base_poly_2) = c("x11","x12","x13","x14","x15","x16","x17","x18")
pred2 = predict(reg, base_poly_2)
x1
as.data.frame(1x,y1)
as.data.frame(x1,y1)
x1
base_poly = as.data.frame(datos$y, poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
colnames(base_poly) = c("y", "x11","x12","x13","x14","x15","x16","x17","x18")
base_poly
base_poly = as.data.frame(datos$y, poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
base_poly
base_poly = as.data.frame(c(datos$y, poly(datos$X, degree = 8, raw = TRUE, simple = TRUE)))
base_poly
base_poly = as.data.frame(poly(datos$X, degree = 8, raw = TRUE, simple = TRUE))
base_poly
base_poly = cbind(datos$y, base_poly)
base_poly
colnames(base_poly) = c("y","x11","x12","x13","x14","x15","x16","x17","x18")
base_poly
base_poly[1,]
data_temp = base_poly[1:i,]
reg = lm(y~., data = data_temp)
reg
pred1 = predict(reg, base_poly[1:(i),1:(i-1)])
base_poly[1:(i),1:(i-1)]
pred1 = predict(reg, base_poly[1:(i),1:(i)])
pred1 = predict(reg, base_poly[1:(i),])
pred1
pred2 = predict(reg, base_poly_2)
pred2
